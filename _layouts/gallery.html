<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title }} | Jakarta Hash House Harriers</title>
  <meta name="description" content="{{ page.description }}">

  <!-- Open Graph -->
  <meta property="og:title" content="{{ page.title }}">
  <meta property="og:description" content="{{ page.description }}">
  <meta property="og:type" content="website">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="{{ '/assets/css/gallery.css' | relative_url }}">
</head>
<body>
  {% include header.html %}

  <!-- Hero Slideshow -->
  {% assign hero_images = site.data.headline_images | default: site.data.gallery_images | sample: 6 %}
  <section class="hero">
    <div class="hero__slides">
      {% for image in hero_images %}
      <div class="hero__slide{% if forloop.first %} active{% endif %}">
        <img src="{{ image.src | relative_url }}" alt="Hash House Harriers Jakarta" loading="{% if forloop.first %}eager{% else %}lazy{% endif %}">
        {% if site.data.headline_captions %}
        <div class="hero__caption">{{ site.data.headline_captions[image.src] | default: "On-on!" }}</div>
        {% endif %}
      </div>
      {% endfor %}
    </div>

    <div class="hero__overlay">
      <h1 class="hero__title">Jakarta Hash House Harriers</h1>
      <p class="hero__tagline">A drinking club with a running problem üç∫</p>
    </div>

    <button class="hero__nav hero__nav--prev" aria-label="Previous slide">&#10094;</button>
    <button class="hero__nav hero__nav--next" aria-label="Next slide">&#10095;</button>

    <div class="hero__indicators">
      {% for image in hero_images %}
      <button class="hero__indicator{% if forloop.first %} active{% endif %}" aria-label="Go to slide {{ forloop.index }}"></button>
      {% endfor %}
    </div>
  </section>

  <!-- Testimonials -->
  <section class="testimonials-wall">
    <h2 class="testimonials-wall__title">Testimonials</h2>
    <p class="testimonials-wall__subtitle">Real reviews from real Hashers</p>
    <div class="testimonials-wall__grid">
      {% for testimonial in site.data.testimonials %}
      <div class="testimonial-card">
        <div class="testimonial-card__stars">
          {% for i in (1..5) %}{% if i <= testimonial.rating %}<span class="star-filled">‚òÖ</span>{% else %}<span class="star-empty">‚òÜ</span>{% endif %}{% endfor %}
        </div>
        <p class="testimonial-card__quote">"{{ testimonial.comment }}"</p>
      </div>
      {% endfor %}
    </div>
  </section>

  <!-- Two-Column Main Content -->
  <div class="main-content">
    <!-- Left Column: Photo Pile -->
    <div class="main-content__left">
      <section class="photo-pile-section">
        <h2 class="photo-pile-section__title">üì∏ Photo Gallery</h2>
        <p class="photo-pile-section__subtitle">Memories from the trails and the circle</p>

        {% assign pile_images = site.data.gallery_images | default: site.data.headline_images %}
        {% assign total_images = pile_images | size %}
        {% assign num_rows = total_images | divided_by: 4 %}
        {% assign pile_height = num_rows | times: 120 | plus: 220 %}
        <div class="photo-pile" style="min-height: {{ pile_height }}px;">
          {% for image in pile_images %}
          {% assign rotation = forloop.index | modulo: 9 | minus: 4 | times: 4 %}
          {% assign col = forloop.index0 | modulo: 4 %}
          {% assign row = forloop.index0 | divided_by: 4 %}
          {% assign left_base = col | times: 23 | plus: 2 %}
          {% assign top_base = row | times: 120 | plus: 20 %}
          {% assign z_index = forloop.index | plus: 1 %}
          <div class="photo-pile__item"
               style="transform: rotate({{ rotation }}deg); left: {{ left_base }}%; top: {{ top_base }}px; z-index: {{ z_index }};"
               data-index="{{ forloop.index0 }}"
               data-src="{{ image.src }}">
            <img src="{{ image.src | relative_url }}" alt="Hash run photo" loading="lazy">
          </div>
          {% endfor %}
        </div>
      </section>
    </div>

    <!-- Right Column: FAQ + Sponsors -->
    <div class="main-content__right">
      <!-- FAQ Section -->
      <section class="faq">
        <h2 class="faq__title">‚ùì FAQ</h2>
        <p class="faq__subtitle">Everything you were afraid to ask</p>

        <div class="faq__list">
          {% for item in site.data.faq %}
          <div class="faq-item">
            <div class="faq-item__question">
              <span>{{ item.question }}</span>
              <span class="faq-item__icon">+</span>
            </div>
            <div class="faq-item__answer">
              <p>{{ item.answer }}</p>
            </div>
          </div>
          {% endfor %}
        </div>
      </section>

      <!-- Sponsors Section -->
      <section class="sponsors">
        <p class="sponsors__title">üç∫ Proudly Sponsored By</p>
        <div class="sponsors__grid">
          {% for sponsor in site.data.sponsors %}
          <div class="sponsor">
            <div class="sponsor__emoji">{{ sponsor.emoji }}</div>
            <div class="sponsor__name">{{ sponsor.name }}</div>
            <div class="sponsor__tagline">{{ sponsor.tagline }}</div>
          </div>
          {% endfor %}
        </div>
      </section>
    </div>
  </div>

  {% include footer.html %}

  <!-- Down-Down Counter (Fixed Position) - Click to increment! -->
  <div class="down-counter">
    <div class="down-counter__label">Down-Downs</div>
    <div class="down-counter__number">6</div>
    <div class="down-counter__emoji">üçª</div>
    <div class="down-counter__hint">tap to drink!</div>
  </div>

  <!-- Down-Down Takeover -->
  <div class="down-takeover">
    <div class="down-takeover__content">
      <div class="down-takeover__emoji">üçªüç∫üçª</div>
      <div class="down-takeover__text">69 DOWN-DOWNS!</div>
      <div class="down-takeover__subtext">nice.</div>
      <div class="down-takeover__emoji">üèÉüç∫üèÉ</div>
    </div>
    <div class="down-takeover__dismiss">click anywhere to reset (coward)</div>
  </div>

  <!-- Lightbox Modal -->
  <div class="lightbox">
    <button class="lightbox__close" aria-label="Close lightbox">&times;</button>
    <button class="lightbox__nav lightbox__nav--prev" aria-label="Previous image">&#10094;</button>
    <div class="lightbox__content">
      <img class="lightbox__image" src="" alt="Gallery image">
      <div class="lightbox__caption"></div>
    </div>
    <button class="lightbox__nav lightbox__nav--next" aria-label="Next image">&#10095;</button>
    <div class="lightbox__counter"></div>
  </div>

  <!-- Caption data for lightbox (generated by scripts/generate-captions.py or fallbacks) -->
  <script id="gallery-captions" type="application/json">
  {% if site.data.gallery_captions %}
  {{ site.data.gallery_captions | jsonify }}
  {% else %}
  {
    "fallback": [
      "Behold: A group of extremely dedicated athletes attempting forward motion. The beer was definitely earned.",
      "Witness: Brave souls engaging in what experts call 'cardio (allegedly)'. Moments before disaster.",
      "Rare footage of a chaotic assembly of questionable decision-makers. This is completely normal behavior.",
      "Scientists baffled by this display of team bonding and essential hydration. The hangover was legendary.",
      "Local news reports: People barely standing after character building exercise. Management takes no responsibility.",
      "Breaking: Evidence of friendship‚Ñ¢ and peer pressure in the wild. And they wonder why we drink.",
      "Leaked image shows humans engaging in what they claim is 'running'. This explains a lot, actually.",
      "Classified photo of survival juice consumption. On-on to questionable decisions!",
      "Historians debate the purpose of this gathering. They knew what they signed up for. (They didn't.)",
      "Experts confirm this is exactly what peak performance looks like. Typical Tuesday, honestly.",
      "Behold: The aftermath of nature's carpet and complimentary mud exfoliation. No hashers were harmed.",
      "Witness: A herd of questionable decision-makers fleeing from responsibility. The circle was... eventful."
    ]
  }
  {% endif %}
  </script>

  <!-- Scripts -->
  <script src="{{ '/assets/js/gallery.js' | relative_url }}"></script>
</body>
</html>
